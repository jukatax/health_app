var app=angular.module("gp",["ngRoute"]);if(app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainController"}).when("/booking",{templateUrl:"views/booking.html",controller:"BookingController"}).when("/booking2",{templateUrl:"views/booking_v2.html",controller:"BookingController"}).otherwise({redirectTo:"/"})}]),app.service("getData",["$http",function(a){var b="/API/toSendData/forBooking",c={get:function(){return a.get("data/data.json")},post:function(c){return console.log(c),a.post(b,c)}};return c}]),app.controller("MainController",["$route","$scope","$location","getData",function(a,b,c,d){b.curpage,b.$on("$routeChangeSuccess",function(a,c,d){b.curpage=c.loadedTemplateUrl,b.page={name:"views/main.html"==b.curpage?"Home":"Booking",home:"views/main.html"==b.curpage,booking:"views/booking.html"==b.curpage,booking2:"views/booking_v2.html"==b.curpage}})}]),app.controller("BookingController",["$scope","$filter","$window","getData","$location",function(a,b,c,d,e){a.user={id:"0123",name:"Mr User",postcode:"IG5 0LQ",dob:"12/12/2000",picture:"images/yuliyan.jpg"},a.gps=[],a.doctors=[],a.doctor=[],a.doctorsVisible=!1,a.timesVisible=!1,a.booking={gp:"",doctor:"",id:"",date:"",time:"",user_id:""},a.disableBooking=!0,a.setGP=function(b){a.gps.forEach(function(c,d){if(a.gps[d].name==b)return a.doctors=a.gps[d].doctors,a.booking.gp="",a.booking.doctor="",a.booking.id="",a.booking.date="",a.booking.time="",a.booking.gp=a.gps[d].id,a.doctorsVisible=!0,a.doctor=[],!0})},a.setDoctor=function(b){a.doctors.forEach(function(c,d){if(a.doctors[d].name==b)return a.doctor=a.doctors[d],a.booking.date="",a.booking.time="",a.booking.doctor=a.doctor.name,a.timesVisible=!0,a.doctorsVisible=!1,!0})},a.setBookingData=function(b,c,d,e){a.booking.id=b,a.booking.date=c,a.booking.time=d,a.booking.user_id=a.user.id,a.disableBooking=!1,a.timesVisible=!1},a.clearBookingData=function(){a.disableBooking=!0},a.bookAppointment=function(){d.post(a.booking).then(function(c){console.log("Booking confirmed! ",c.data),a.clearBookingData()},function(b){console.log("Booking error, try again later! ",b)})},d.get().then(function(c){a.gps=c.data.all},function(b){console.log(b)})}]),app.directive("manageClicks",["$document","$window","$timeout",function(a,b,c){return{restrict:"A",controller:"BookingController",link:function(a,b,c){jQuery(".selectable");jQuery("body").on("click touchstart",".selectable",function(b){jQuery(this).parents(".booking").addClass("active").find(".selected").removeClass("selected").end().next(".booking").find(".selected").removeClass("selected").end().end().end().addClass("selected").parents(".mainListItem").children(".date").addClass("selected"),a.removeSelected=function(a){jQuery(a).removeClass("selected")}})}}}]),app.directive("menuClicks",["$document","$window",function(a,b){return{restrict:"A",link:function(a,c,d){function g(){e=document.body.clientWidth||document.documentElement.clientWidth,f="click",console.log(e),jQuery("body").off(f).on(f,".mobileToggle , header nav ul li",function(a){jQuery("header nav ul li").toggleClass("menuShow")})}var e,f;g(),jQuery(b).resize(function(){g()})}}}]),app.directive("popupOffset",["$document","$window",function(a,b){return{restrict:"A",link:function(a,c,d){function i(){f=document.body.scrollTop||document.documentElement.scrollTop,e=document.body.clientWidth||document.documentElement.clientWidth,g=(e-h.width())/2,h.css({top:f+10+"px",left:g+"px"})}var e,f,g,h=jQuery(".overlay .popup");i(),jQuery(b).off("scroll resize").on("scroll resize",function(){i()})}}}]),"function"==typeof io){var socket=io();socket.on("doRefresh",function(){window.location.reload(!0)})}